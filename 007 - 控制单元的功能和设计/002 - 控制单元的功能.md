# 控制单元的外特性

![[Pasted image 20240105162853.png]]
## 输入信号

1. 时钟
	- CU受时钟控制
	- 一个时钟脉冲发一个操作命令或一组须同时执行的操作命令
2. 指令寄存器
	- OP( IR ) -> CU ( ID )
	- 控制信号与操作码有关
3. 标志
	CU受标志位控制
4. 外来信号
	- INTP 中断请求
	- HRQ 总线请求
## 输出信号

1. CPU内各种控制信号
	- Ri -> Rj
	- ( PC ) + 1 -> PC
	- ALU +、-、与、或
2. 送至控制总线的信号
	- MREQ# 方寸控制信号
	- IO#/M 访IO/存储器的控制信号
	- RD# 读命令
	- WR# 写命令
	- INTA 中断响应信号
	- HLDA 总线响应信号
# 控制信号举例

ADD @ X
## 不采用CPU内部总线的方式

![[Pasted image 20240105163833.png]]





## 采用CPU内部总线的方式

![[Pasted image 20240106122403.png]]
1. PC -> MAR -> 地址线  **PCo MARi**
2. 1 -> R  **CU发读命令**
3. 数据线 -> MDR 
4. MDR -> IR  **MDRo IRi**
5. OP( IR ) -> CU
6. ( PC ) + 1 -> PC
i 表示输入控制，o 表示输出控制

**例题**
设CPU内部结构如上图所示，此外还设有B、C、D、E、H、L六个寄存器，它们各自的输入和输出端都与内部总线相通，并分别受控制信号控制（如Bi为寄存器B的输入控制；Bo为B的输出控制）。要求从取指令开始，写出完成下列指令所需的全部微操作和控制信号。
- ADD   B，C；( ( B ) + ( C ) -> B )
	- 取指周期
		1. PC ->Bus -> MAR  PCo MARi
		2. 1 -> R  R/W# = R
		3. M( MAR ) -> MDR  MDRi
		4. MDR ->Bus -> IR  MDRo IRi
		5. OP( IR ) -> CU
		6. ( PC ) + 1 -> PC PC + 1
		注意：
		- 不要漏写Bus
		- 第三步控制信号无MARo，因为MARo是优先于1->R的（先找到地址再读），所以就不用写了。
		- 不要漏写最后一步
	- 执行周期
		1.  C->Bus-> Y  Co Yi
		2. ( Y )  + ( B ) -> ALU -> Z   Bo ALUi "+" ( Zi )
		3. Z -> B  Zo Bi
		注意：
		- 取寄存器内的数据要加括号
		- 不要漏写Bus
		- 运算类的指令一定要经过ALU
		- 第二步没有Yo，因为看图Y和ALU直接相连，Zi可写可不写，因为图中也没有Zi
- SUB    A，H；( ( AC ) - ( H ) -> AC )
	- 取指周期
		1. PC -> Bus -> MAR  PCo MARi
		2. 1 -> R  R/W# = R
		3. M( MAR ) -> MDR  MDRo
		4. MDR ->Bus -> IR  MDRo IRi
		5. OP( IR ) -> CU
		6. ( PC ) + 1 -> PC  PC + 1
	- 执行周期（不确定ALU对于减数和被减数有什么具体要求）
		1. AC -> Bus -> Y  ACo Yi
		2. ( Y ) - ( H ) -> ALU -> Z  Ho ALUi "-" ( Zi )
		3. Z ->Bus -> AC  Zo ACi
# 多级时序系统

## 机器周期

- 概念：所有指令执行过程中的一个基准时间
- 确定机器周期需要考虑的因素
	- 每条指令的执行步骤
	- 每一步骤所需的时间
- 基准时间的确定
	- 以完成最复杂指令功能的时间为准
	- 以访问一次存储器的时间为基准
若指令字长 = 存储字长 -> 取指周期 = 机器周期
	指令字长 = 存储字长，说明一次访存即可将一条指令取出，一次访存的时间为机器周期，取一条指令的时间为取指周期，所以取指周期 = 机器周期
## 时钟周期

一个机器周期内可完成若干微操作（允许并发，而非严格先后）
	将一个机器周期分成若干个时间相等的时间段（节拍 = 状态 = 时钟周期）
	时钟周期是控制计算机操作的最小时间单位
	用时钟周期控制产生一个或几个微操作命令
	时钟周期（CLK或T状）为工作频率的倒数
## 多级时序系统

一个指令周期包含若干个机器周期
一个机器周期包含若干个时钟周期
我们只有二级时序，别的教科书有三级时序
![[Pasted image 20240106125831.png]]
## 机器速度与机器主频的关系

机器的主频 f 越快机器的速度也越快
在**机器周期所含时钟周期数相同**的前提下，两机平均指令执行速度之比等于两机主频之比
![[Pasted image 20240106130001.png]]
机器速度不仅与主频有关 ，还与机器周期中所含时钟周期（主频的倒数）数以及指令周期中所含的机器周期数有关
# 控制方式


