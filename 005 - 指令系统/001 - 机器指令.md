
# 机器指令

## 指令的一般格式

### 操作码（OP）字段

- 长度固定
	- 用于指令字长较长的情况或RISC机
- 长度可变
	- 可通过扩展操作码，有效缩短字长
#### 扩展操作码技术

操作码的位数随地址数的减少而增加
- **操作码扩展**
	- 三地址指令操作码每减少一种可多构成$2^4$ 种二地址指令
	- 二地址指令操作码每减少一种可多构成$2^4$ 种一地址指令

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Computer-organization/202402131048104.png)

假设指令字长为16位，操作数的地址码为6位，指令有零地址、一地址、二地址三种格式。

**（1）设操作码固定，若零地址指令有P种，一地址指令有Q种，则二地址指令最多有几种？**
	16 - P - Q
	
**（2）采用操作码的扩展技术，若二地址指令有X种，零地址指令有Y种，则一地址指令最多有几种？**
	设一地址指令M种
	Y = ( ( 16 - X ) * $2^6$ - M ) * $2^6$

变式：地址的位数并不是相同的。
### 地址码字段
#### 四地址
| OP | A1 | A2 | A3 | A4 |
| ---- | ---- | ---- | ---- | ---- |
A1：第一操作数地址
A2：第二操作数地址
A3：结果的地址
A4：下一条指令地址
( A1 ) OP ( A2 ) -> A3
四次访存
1. 取第一操作数
2. 取第二操作数
3. 存第三操作数
4. 取下一条指令
#### 三地址
| OP  | A1  | A2  | A3  |
| --- | --- | --- | --- |
( A1 ) OP ( A2 ) -> A3
四次访存（不确定）
1. 取第一操作数
2. 取第二操作数
3. 存结果到A3
4. 取下一条指令

#### 二地址
| OP | A1 | A2 |
| ---- | ---- | ---- | 
( A1 ) OP ( A2 ) -> A1 / ( A1 ) OP ( A2 ) -> A2
四次访存
若运算结果存于ACC，则三次访存

#### 一地址（隐含寻址）
| OP | A1 |
| ---- | ---- |
( ACC ) OP ( A1 ) -> ACC
两次访存
常用操作：取非、取反、+1、-1、移位操作
#### 零地址

无地址码
常用操作：停机指令（HALT）、空操作指令
## 指令字长

指令字长（一个指令字中包含的二进制数的总位数）取决于
- 操作码的长度
- 操作数地址的长度
- 操作数地址的个数

## 辨析

**指令字长、存储字长 and 机器字长**
字长：**一个字中的二进制位的位数**

机器字长的定义见
[[001 - 第一章考点#0x01 机器字长]]
指令字长 = 机器字长 -> 单字长指令
指令字长 = 半个机器字长 -> 半字长指令
指令字长 = 两个机器字长 -> 双字长指令

存储字长：**一个存储单元存储二进制代码的位数**。
指令字长固定：指令字长 = 存储字长
指令字长可变：按字节的倍数变化 16位 32位 64位等

机器字长是和数学运算紧密相关的，**属于相对独立的部分，但是，也会影响到存储字长的长度**（eg：如果存储字长太短，那么就需要多次存取才能够存取一个字，影响系统的整体效率。**机器字长是32位，存储字长可以是32位或者16位，即机器字长可以和存储字长不同**）。